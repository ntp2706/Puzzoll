<!-- Width = 1536px -->
<!-- Height = 695px -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/png" href="/P.png"/>
    <title>Puzzoll</title>
    <style>
        body{
            background-image: url('spiderman/background.png');
            background-attachment: fixed;
            background-size: 100% 100%;
        }
        .maintitle{
            margin-top: 10px;
            margin-left: 10px;
        }
        #board-time{
          font-family: 'Courier New', Courier, monospace;
          margin-left: 10px;
          font-size: x-large;
          color: black;
          display: inline-block;
          padding: 20px 52px;
          border: 4px solid black;
          background-color: white;
          border-radius: 20px;
        }
        #sample{
          margin-top: -429px;
          margin-left: 120px;
        }
        #shuffle{
          height: 60px;
          width: 60px;
          cursor: pointer;
          margin-top: 430px;
          margin-left: 60px;
        }
        #popup {
          position: relative;
          display: inline-block;
          cursor: pointer;
          -webkit-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
        }
        #popup .popuptext {
          visibility: hidden;
          background-color: #555;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 8px 0;
          position: absolute;
          z-index: 1;
        }
        #myPopup{
          width: 160px;
          margin-top: -100px;
          margin-left: 10px;
        }
        #myPopupwin{
          width: 230px;
          margin-top: -333px;
          margin-left: 525px;
        }
        #popup .popuptext::after {
          content: "";
          position: absolute;
          top: 100%;
          left: 50%;
          margin-left: -5px;
          border-width: 5px;
          border-style: solid;
          border-color: #555 transparent transparent transparent;
        }
        #popup .show {
          visibility: visible;
          -webkit-animation: fadeIn 1s;
          animation: fadeIn 1s;
        }
        @-webkit-keyframes fadeIn {
          from {opacity: 0;} 
          to {opacity: 1;}
        }
        @keyframes fadeIn {
          from {opacity: 0;}
          to {opacity:1 ;}
        }
        #puzzle .cell-puzzle {
            width: 120px;
            height: 120px;
            border: 4px solid transparent;
            margin-left: 522px;
            margin-top: 121.5px;
            position: absolute;
        }
        #puzzle > .row-1 {
            top: 0;
        }
        #puzzle > .row-2 {
            top: 124px;
        }
        #puzzle > .row-3 {
            top: 248px;
        }
        #puzzle > .row-4 {
            top: 372px;
        }
        #puzzle > .col-1 {
            left: 0;
        }
        #puzzle > .col-2 {
            left: 124px;
        }
        #puzzle > .col-3 {
            left: 248px;
        }
        #puzzle > .col-4 {
            left: 372px;
        }
        #control{
          width: 40px;
          height: 40px;
          cursor: pointer;
        }
        #control .up{
            margin-top: -68.5px;
            margin-left: 562px;
            position: absolute;
            border: 5px solid transparent;
        }
        #control > .un1{
            left: 0;
        }
        #control > .un2{
            left: 124px;
        }
        #control > .un3{
            left: 248px;
        }
        #control > .un4{
            left: 372px;
        }
        #control .left{
            margin-top: 161.5px;
            margin-left: 469px;
            position: absolute;
            border: 5px solid transparent;
        }
        #control > .ln1{
            top: 0;
        }
        #control > .ln2{
            top: 124px;
        }
        #control > .ln3{
            top: 248px;
        }
        #control > .ln4{
            top: 372px;
        }
        #control .right{
            margin-top: 161.5px;
            margin-left: 1010px;
            position: absolute;
            border: 5px solid transparent;
        }
        #control > .rn1{
            top: 0;
        }
        #control > .rn2{
            top: 124px;
        }
        #control > .rn3{
            top: 248px;
        }
        #control > .rn4{
            top: 372px;
        }
        #control .down{
            margin-top: 473px;
            margin-left: 562px;
            position: absolute;
            border: 5px solid transparent;
        }
        #control > .dn1{
            left: 0;
        }
        #control > .dn2{
            left: 124px;
        }
        #control > .dn3{
            left: 248px;
        }
        #control > .dn4{
            left: 372px;
        }
    </style>
</head>
<body>
    <a class="maintitle" href="index.html">
        <img src="logo.png" height="40" width="217"></img>
    </a>
    <div> <hr> </div>
    <div id="board-time">00 | 00</div>
    <div id="puzzle">
        <div number="1" class="cell-puzzle row-1 col-1">
          <img src="spiderman/pic1.png" height="120px" width="120px"></img>
        </div>
        <div number="2" class="cell-puzzle row-1 col-2">
          <img src="spiderman/pic2.png" height="120px" width="120px"></img>
        </div>
        <div number="3" class="cell-puzzle row-1 col-3">
          <img src="spiderman/pic3.png" height="120px" width="120px"></img>
        </div>
        <div number="4" class="cell-puzzle row-1 col-4">
          <img src="spiderman/pic4.png" height="120px" width="120px"></img>
        </div>
        <div number="5" class="cell-puzzle row-2 col-1">
          <img src="spiderman/pic5.png" height="120px" width="120px"></img>
        </div>
        <div number="6" class="cell-puzzle row-2 col-2">
          <img src="spiderman/pic6.png" height="120px" width="120px"></img>
        </div>
        <div number="7" class="cell-puzzle row-2 col-3">
          <img src="spiderman/pic7.png" height="120px" width="120px"></img>
        </div>
        <div number="8" class="cell-puzzle row-2 col-4">
          <img src="spiderman/pic8.png" height="120px" width="120px"></img>
        </div>
        <div number="9" class="cell-puzzle row-3 col-1">
          <img src="spiderman/pic9.png" height="120px" width="120px"></img>
        </div>
        <div number="10" class="cell-puzzle row-3 col-2">
          <img src="spiderman/pic10.png" height="120px" width="120px"></img>
        </div>
        <div number="11" class="cell-puzzle row-3 col-3">
          <img src="spiderman/pic11.png" height="120px" width="120px"></img>
        </div>
        <div number="12" class="cell-puzzle row-3 col-4">
          <img src="spiderman/pic12.png" height="120px" width="120px"></img>
        </div>
        <div number="13" class="cell-puzzle row-4 col-1">
          <img src="spiderman/pic13.png" height="120px" width="120px"></img>
        </div>
        <div number="14" class="cell-puzzle row-4 col-2">
          <img src="spiderman/pic14.png" height="120px" width="120px"></img>
        </div>
        <div number="15" class="cell-puzzle row-4 col-3">
          <img src="spiderman/pic15.png" height="120px" width="120px"></img>
        </div>
        <div number="16" class="cell-puzzle row-4 col-4">
            <img src="spiderman/pic16.png" height="120px" width="120px"></img>
        </div>
      </div>
      <div id="control">
        <div number="1" class="up un1">
            <img src="up.png" height="40px" width="40px"></img>
        </div>
        <div number="2" class="up un2">
            <img src="up.png" height="40px" width="40px"></img>
        </div>
        <div number="3" class="up un3">
            <img src="up.png" height="40px" width="40px"></img>
        </div>
        <div number="4" class="up un4">
            <img src="up.png" height="40px" width="40px"></img>
        </div>
        <div number="1" class="left ln1">
          <img src="left.png" height="40px" width="40px"></img>
        </div>
        <div number="2" class="left ln2">
          <img src="left.png" height="40px" width="40px"></img>
        </div>
        <div number="3" class="left ln3">
          <img src="left.png" height="40px" width="40px"></img>
        </div>
        <div number="4" class="left ln4">
          <img src="left.png" height="40px" width="40px"></img>
        </div>
        <div number="1" class="right rn1">
          <img src="right.png" height="40px" width="40px"></img>
        </div>
        <div number="2" class="right rn2">
          <img src="right.png" height="40px" width="40px"></img>
        </div>
        <div number="3" class="right rn3">
          <img src="right.png" height="40px" width="40px"></img>
        </div>
        <div number="4" class="right rn4">
          <img src="right.png" height="40px" width="40px"></img>
        </div>
        <div number="1" class="down dn1">
          <img src="down.png" height="40px" width="40px"></img>
        </div>
        <div number="2" class="down dn2">
          <img src="down.png" height="40px" width="40px"></img>
        </div>
        <div number="3" class="down dn3">
          <img src="down.png" height="40px" width="40px"></img>
        </div>
        <div number="4" class="down dn4">
          <img src="down.png" height="40px" width="40px"></img>
        </div>
      </div>
      <div id="popup" onclick="popupactive()">
        <div id="shuffle">
          <img src="shuffle.png" height="60px" width="60px"></img>
        </div>
        <span class="popuptext" id="myPopup">Ấn vào đây để bắt đầu</span>
      </div>
      <div id="popup">
        <span class="popuptext" id="myPopupwin"></span>
      </div>
      <div id="sample">
        <img src="spiderman/spidermanori.jpg" height="244px" width="244px"></img>
      </div>
    </div>
  </div>
</body>
</html>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
  var matrix = [
  [1, 2, 3, 4],
  [5, 6, 7, 8],
  [9, 10, 11, 12],
  [13, 14, 15, 16],
];
  var num = [];
  var obj = [];
  var secs = 0;
  var currentSeconds = 0;
  var currentMinutes = 0;
  var timer;
  var clicked = 0;
  $("#shuffle").bind("click",function(){
   initialize();
})
popupactive();
  function popupactive() {
    var popup = document.getElementById("myPopup");
    if(clicked < 2){
    popup.classList.toggle("show");
    clicked++;;
    }
  }
function initialize(){
  var arrRandomNumber = shuffleMatrix();
  var count = 0;
  beginTime();
  for(var i = 0; i < 4; i++) {
    for(var j = 0; j < 4; j++) {
      var number = arrRandomNumber[count];
      matrix[i][j] = number;
      $("#puzzle .cell-puzzle[number=" + number + "]").css("top", i * 124 + "px");
      $("#puzzle .cell-puzzle[number=" + number + "]").css("left", j * 124 + "px");
      count++;
    }
  }
}
function shuffleMatrix(){
  var arr = [];
  while(arr.length < 16){
    var r = Math.floor(Math.random() * 16) + 1;
    if(arr.indexOf(r) === -1) arr.push(r);
  }
  return arr;
}
function beginTime() {
  secs = 0;
  currentSeconds = 0;
  currentMinutes = 0;
  clearTimeout(timer);
  intervalTime();
}
function intervalTime() {
  currentMinutes = Math.floor(secs / 60);
  currentSeconds = secs % 60;
  if(currentMinutes <= 9) {
    currentMinutes = "0" + currentMinutes;
  }
  if(currentSeconds <= 9) {
    currentSeconds = "0" + currentSeconds;
  }
  secs++;
  $("#board-time").text(currentMinutes + " | " + currentSeconds);
  $("#myPopupwin").text("YOU WIN!!! Thời gian "+currentMinutes + "p " + currentSeconds+"s (Khởi động lại sau 5s)")
  timer = setTimeout('intervalTime()', 1000);
  console.log(secs);
}
 
//đọc di chuyển xuống
$("#control .dn1").bind("click",function() {
    if(secs > 0){
        movedown(1);
      }
  })
  $("#control .dn2").bind("click",function() {
    if(secs > 0){
        movedown(2);
      }
  })
  $("#control .dn3").bind("click",function() {
    if(secs > 0){
        movedown(3);
      }
  })
  $("#control .dn4").bind("click",function() {
    if(secs > 0){
        movedown(4);
      }
  })

  function movedown(numofcol) { //hàm gọi di chuyển xuống
    var temp = matrix[3][numofcol-1];
    var win = false
  for(var i = 0; i < 4; i++) {
      num[i]= matrix[i][numofcol-1];
      matrix[i][numofcol-1] = num[i-1];
      obj[i] = $("#puzzle .cell-puzzle[number="+ num[i] +"]");
      if(i!==3){
      obj[i].css(
            'top',  (i+1)*124+ 'px'
            );}
            else {
      obj[i].css(
            'top',  0+ 'px'
            );}
    } 
    matrix[0][numofcol-1] = temp;
    win = checkWin();
        if (win){
          return;
        }
    }
    //đọc di chuyển lên
    $("#control .un1").bind("click",function() {
    if(secs > 0){
        movedown(1);
        movedown(1);
        movedown(1);
      }
  })
  $("#control .un2").bind("click",function() {
    if(secs > 0){
        movedown(2);
        movedown(2);
        movedown(2);
      }
  })
  $("#control .un3").bind("click",function() {
    if(secs > 0){
        movedown(3);
        movedown(3);
        movedown(3);
      }
  })
  $("#control .un4").bind("click",function() {
    if(secs > 0){
        movedown(4);
        movedown(4);
        movedown(4);
      }
  })

     //đọc di chuyển sang phải
  $("#control .rn1").bind("click",function() {
    if(secs > 0){
        moveright(1);
      }
  })
  $("#control .rn2").bind("click",function() {
    if(secs > 0){
        moveright(2);
      }
  })
  $("#control .rn3").bind("click",function() {
    if(secs > 0){
        moveright(3);
      }
  })
  $("#control .rn4").bind("click",function() {
    if(secs > 0){
        moveright(4);
      }
  })

  function moveright(numofrow) { //hàm gọi di chuyển sang phải
    var temp = matrix[numofrow-1][3];
    var win = false;
  for(var i = 0; i < 4; i++) {
      num[i]= matrix[numofrow-1][i];
      matrix[numofrow-1][i] = num[i-1];
      obj[i] = $("#puzzle .cell-puzzle[number="+ num[i] +"]");
      if(i!==3){
      obj[i].css(
            'left',  (i+1)*124+ 'px'
            );}
            else {
      obj[i].css(
            'left',  0+ 'px'
            );}
    } 
    matrix[numofrow-1][0] = temp;
    win = checkWin();
        if (win){
          return;
        }
    }
     //đọc di chuyển sang trái
  $("#control .ln1").bind("click",function() {
    if(secs > 0){
        moveright(1);
        moveright(1);
        moveright(1);
      }
  })
  $("#control .ln2").bind("click",function() {
    if(secs > 0){
        moveright(2);
        moveright(2);
        moveright(2);
      }
  })
  $("#control .ln3").bind("click",function() {
    if(secs > 0){
        moveright(3);
        moveright(3);
        moveright(3);
      }
  })
  $("#control .ln4").bind("click",function() {
    if(secs > 0){
        moveright(4);
        moveright(4);
        moveright(4);
      }
  })
    function checkWin(){
    var winner =false;
    var winString = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16";
    var matrixStr = matrix.toString();
    var popup = document.getElementById("myPopupwin");
    if(winString == matrixStr) {
        clearTimeout(timer);
        popup.classList.toggle("show");
        timer = setTimeout('restart()', 5000);
        return;
    } }
    function restart(){
      window.location.href = 'harder.html';
    }
</script>